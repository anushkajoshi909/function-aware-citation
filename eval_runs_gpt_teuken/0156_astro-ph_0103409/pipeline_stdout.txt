âœ… Available Models:
1. alias-reasoning
2. alias-ha
3. meta-llama/Llama-3.3-70B-Instruct
4. meta-llama/Llama-3.1-8B-Instruct
5. Qwen/Qwen2-VL-7B-Instruct
6. alias-vision
7. openGPT-X/Teuken-7B-instruct-research-v0.4
8. deepseek-ai/DeepSeek-Coder-V2-Lite-Instruct
9. Qwen/Qwen3-Coder-30B-A3B-Instruct
10. alias-code
11. Qwen/Qwen3-Embedding-4B
12. BAAI/bge-reranker-v2-m3
13. stabilityai/stable-diffusion-3.5-large-turbo
14. alias-image-generation
15. black-forest-labs/FLUX.1-dev
16. openai/whisper-large-v3
17. Kokoro-82M
18. tts-1-hd
19. deepseek-ai/DeepSeek-R1
20. openai/gpt-oss-120b
21. meta-llama/Llama-4-Scout-17B-16E-Instruct

ðŸ‘‰ Select a model number (default = 1): 
âœ… Using model: openGPT-X/Teuken-7B-instruct-research-v0.4

ðŸ” Enter a scientific query or topic: 
ðŸ”Ž Citation Function Classification:
{
  "citation_functions": [
    "Background",
    "Motivation"
  ],
  "justification": "The query seeks to understand how the current work builds on previous studies and what motivates the investigation of poloidal magnetic field stability in accretion discs."
}

âœ… Saved to classified_outputs.jsonl
ðŸ”§ Ready for retrieval module (handled in a separate file).
âš¡ SKIP_REINDEX=1 â€” using existing FAISS index + meta; not scanning raw JSONL shards.
âœ… Top-k candidates (FAISS): /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
[14:31:07] main | args: Namespace(max_check=10, debug=True)
[14:31:07] read_last_jsonl | path= classified_outputs.jsonl
[14:31:07] read_last_jsonl | total_lines= 1
[14:31:07] main | query='How does the current work extend and compare with previous studies on the stability of poloidal magnetic fields in accretion discs?' | funcs=['Background', 'Motivation']
[14:31:08] main | core_terms= ['accretion discs', 'poloidal magnetic fields', 'stability']
[14:31:08] load_topk_jsonl | path= /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/outputs/topk_candidates_query.jsonl
[14:31:08] load_topk_jsonl | rows= 20
[14:31:08] load_topk_jsonl | first: rank= 0 paper_id= astro-ph/0103409 title_snip='Stability of accretion discs threaded by a strong magnetic field' abs_len= 1614
[14:31:08] main | running function= Background
[14:31:08] select | function= Background | candidates_in= 20
[14:31:08] select | core_terms= ['accretion discs', 'poloidal magnetic fields', 'stability']
[14:31:08] select | no cosine prune; kept=20/20
[14:31:08] select | pool_size= 10 | ranks= [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] | pids= ['astro-ph/0103409', 'astro-ph/0102045', 'astro-ph/0103230', 'astro-ph/0101470', 'astro-ph/0101293', 'astro-ph/0102178', 'astro-ph/0101237', 'physics/0104072', 'astro-ph/0104130', 'astro-ph/0104385']
[14:31:08] select | verify relaxed 1/10
[14:31:08] verify | func= Background | rank= 0 | pid= astro-ph/0103409 | title_snip='Stability of accretion discs threaded by a strong magnetic field' | abs_len= 1614
[14:31:12] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= False
[14:31:12] select | verify relaxed 2/10
[14:31:12] verify | func= Background | rank= 1 | pid= astro-ph/0102045 | title_snip='Magnetohydrodynamic simulations of black hole accretion' | abs_len= 804
[14:31:15] verify | result supports= False fit= 0.00 top= 0.90 invalid= off_topic_no_core_in_abstract cue_hint= False
[14:31:15] select | verify relaxed 3/10
[14:31:15] verify | func= Background | rank= 2 | pid= astro-ph/0103230 | title_snip='Stability of Accretion Disks in Presence of Nucleosynthesis' | abs_len= 767
[14:31:18] verify | result supports= False fit= 0.00 top= 0.50 invalid= â€” cue_hint= False
[14:31:18] select | verify relaxed 4/10
[14:31:18] verify | func= Background | rank= 3 | pid= astro-ph/0101470 | title_snip='Global accretion disk simulations of magneto-rotational instability' | abs_len= 1500
[14:31:21] verify | result supports= False fit= 0.00 top= 0.90 invalid= off_topic_no_core_in_abstract cue_hint= False
[14:31:21] select | verify relaxed 5/10
[14:31:21] verify | func= Background | rank= 4 | pid= astro-ph/0101293 | title_snip='Numerical simulations of the Accretion-Ejection Instability in
  magneâ€¦' | abs_len= 940
[14:31:24] verify | result supports= False fit= 0.00 top= 0.80 invalid= â€” cue_hint= False
[14:31:24] select | verify relaxed 6/10
[14:31:24] verify | func= Background | rank= 5 | pid= astro-ph/0102178 | title_snip='Magnetic Screening in Accreting Neutron Stars' | abs_len= 1626
[14:31:27] verify | result supports= False fit= 0.00 top= 0.20 invalid= â€” cue_hint= False
[14:31:27] select | verify relaxed 7/10
[14:31:27] verify | func= Background | rank= 6 | pid= astro-ph/0101237 | title_snip='The Effects of Magnetic Fields on Radiative Cooling Jets' | abs_len= 682
[14:31:30] verify | result supports= False fit= 0.00 top= 0.20 invalid= â€” cue_hint= False
[14:31:30] select | verify relaxed 8/10
[14:31:30] verify | func= Background | rank= 7 | pid= physics/0104072 | title_snip='Axisymmetric equilibria of a gravitating plasma with incompressible
  â€¦' | abs_len= 1596
[14:31:33] verify | result supports= False fit= 0.00 top= 0.90 invalid= off_topic_no_core_in_abstract cue_hint= False
[14:31:33] select | verify relaxed 9/10
[14:31:33] verify | func= Background | rank= 8 | pid= astro-ph/0104130 | title_snip='Magnetohydrodynamic Simulations of Accretion Disks around a Weakly
  Mâ€¦' | abs_len= 1273
[14:31:36] verify | result supports= False fit= 0.00 top= 0.80 invalid= no_quote cue_hint= False
[14:31:36] select | verify relaxed 10/10
[14:31:36] verify | func= Background | rank= 9 | pid= astro-ph/0104385 | title_snip='Temperature profiles of accretion discs around rapidly rotating strangâ€¦' | abs_len= 1393
[14:31:39] verify | result supports= False fit= 0.00 top= 0.50 invalid= â€” cue_hint= False

================================================================================
FUNCTION: Background
QUERY   : How does the current work extend and compare with previous studies on the stability of poloidal magnetic fields in accretion discs?
- WINNER: astro-ph/0103409 | Stability of accretion discs threaded by a strong magnetic field
- QUOTE : stability of poloidal magnetic fields anchored in a thin accretion disc
- WHY   : sufficient
[14:31:40] main | running function= Motivation
[14:31:40] select | function= Motivation | candidates_in= 20
[14:31:40] select | core_terms= ['accretion discs', 'poloidal magnetic fields', 'stability']
[14:31:40] select | no cosine prune; kept=20/20
[14:31:40] select | pool_size= 10 | ranks= [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] | pids= ['astro-ph/0103409', 'astro-ph/0102045', 'astro-ph/0103230', 'astro-ph/0101470', 'astro-ph/0101293', 'astro-ph/0102178', 'astro-ph/0101237', 'physics/0104072', 'astro-ph/0104130', 'astro-ph/0104385']
[14:31:40] select | verify relaxed 1/10
[14:31:40] verify | func= Motivation | rank= 0 | pid= astro-ph/0103409 | title_snip='Stability of accretion discs threaded by a strong magnetic field' | abs_len= 1614
[14:31:44] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= False
[14:31:44] select | verify relaxed 2/10
[14:31:44] verify | func= Motivation | rank= 1 | pid= astro-ph/0102045 | title_snip='Magnetohydrodynamic simulations of black hole accretion' | abs_len= 804
[14:31:47] verify | result supports= False fit= 0.00 top= 0.90 invalid= off_topic_no_core_in_abstract cue_hint= False
[14:31:47] select | verify relaxed 3/10
[14:31:47] verify | func= Motivation | rank= 2 | pid= astro-ph/0103230 | title_snip='Stability of Accretion Disks in Presence of Nucleosynthesis' | abs_len= 767
[14:31:50] verify | result supports= False fit= 0.00 top= 0.90 invalid= off_topic_no_core_in_abstract cue_hint= False
[14:31:50] select | verify relaxed 4/10
[14:31:50] verify | func= Motivation | rank= 3 | pid= astro-ph/0101470 | title_snip='Global accretion disk simulations of magneto-rotational instability' | abs_len= 1500
[14:31:53] verify | result supports= False fit= 0.00 top= 0.80 invalid= quote_not_in_abstract cue_hint= False
[14:31:53] select | verify relaxed 5/10
[14:31:53] verify | func= Motivation | rank= 4 | pid= astro-ph/0101293 | title_snip='Numerical simulations of the Accretion-Ejection Instability in
  magneâ€¦' | abs_len= 940
[14:31:56] verify | result supports= False fit= 0.00 top= 0.80 invalid= â€” cue_hint= False
[14:31:56] select | verify relaxed 6/10
[14:31:56] verify | func= Motivation | rank= 5 | pid= astro-ph/0102178 | title_snip='Magnetic Screening in Accreting Neutron Stars' | abs_len= 1626
[14:31:59] verify | result supports= False fit= 0.00 top= 0.20 invalid= â€” cue_hint= False
[14:31:59] select | verify relaxed 7/10
[14:31:59] verify | func= Motivation | rank= 6 | pid= astro-ph/0101237 | title_snip='The Effects of Magnetic Fields on Radiative Cooling Jets' | abs_len= 682
[14:32:01] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[14:32:01] select | verify relaxed 8/10
[14:32:01] verify | func= Motivation | rank= 7 | pid= physics/0104072 | title_snip='Axisymmetric equilibria of a gravitating plasma with incompressible
  â€¦' | abs_len= 1596
[14:32:04] verify | result supports= False fit= 0.00 top= 0.90 invalid= off_topic_no_core_in_abstract cue_hint= False
[14:32:04] select | verify relaxed 9/10
[14:32:04] verify | func= Motivation | rank= 8 | pid= astro-ph/0104130 | title_snip='Magnetohydrodynamic Simulations of Accretion Disks around a Weakly
  Mâ€¦' | abs_len= 1273
[14:32:07] verify | result supports= False fit= 0.00 top= 0.80 invalid= no_quote cue_hint= False
[14:32:07] select | verify relaxed 10/10
[14:32:07] verify | func= Motivation | rank= 9 | pid= astro-ph/0104385 | title_snip='Temperature profiles of accretion discs around rapidly rotating strangâ€¦' | abs_len= 1393
[14:32:10] verify | result supports= False fit= 0.00 top= 0.50 invalid= no_quote cue_hint= False

================================================================================
FUNCTION: Motivation
QUERY   : How does the current work extend and compare with previous studies on the stability of poloidal magnetic fields in accretion discs?
- WINNER: astro-ph/0103409 | Stability of accretion discs threaded by a strong magnetic field
- QUOTE : stability of poloidal magnetic fields anchored in a thin accretion disc
- WHY   : sufficient

================================================================================
UNIFIED ANSWER (1â€“2 sentences, tagged):
The current work builds upon previous studies on the stability of poloidal magnetic fields in accretion discs, confirming the existence of the interchange instability and exploring the effects of magnetic forces on disc stability [Background] (astro-ph/0103409). The research is motivated by the potential of this instability to be the main angular momentum transport mechanism in discs with strong poloidal magnetic fields, particularly in jet-producing discs [Motivation] (astro-ph/0103409).

ðŸ“„ Saved: outputs/function_selection_results.json
ðŸ“„ Saved: outputs/function_selection_results.jsonl
ðŸ“ Unified answer: outputs/function_answer_unified.txt
-> /home/anpa439f/anaconda3/envs/myenv/bin/python3 /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/classifying_question.py  (cwd=/data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration)
âœ… Saved to classified_outputs.jsonl
ðŸ”§ Ready for retrieval module (.py).
-> /home/anpa439f/anaconda3/envs/myenv/bin/python3 /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/Retreival_query_based.py --skip-reindex --index /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/e5_index_subset_1/index.faiss --meta /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/e5_index_subset_1/meta.parquet --topk 20  (cwd=/data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration)
âœ… Top-k candidates: /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
ðŸ”— Symlinked: /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/outputs/topk_candidates_query.jsonl -> /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
-> /home/anpa439f/anaconda3/envs/myenv/bin/python3 /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/function_based_answer-2_copy.py --debug --max-check 10  (cwd=/data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration)

ðŸŽ‰ Pipeline complete.
  â€¢ Classified file : /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/classified_outputs.jsonl
  â€¢ TopK (canonical): /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
  â€¢ Final outputs   : /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs
