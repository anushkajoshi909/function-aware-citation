âœ… Available Models:
1. alias-reasoning
2. alias-ha
3. meta-llama/Llama-3.3-70B-Instruct
4. meta-llama/Llama-3.1-8B-Instruct
5. Qwen/Qwen2-VL-7B-Instruct
6. alias-vision
7. openGPT-X/Teuken-7B-instruct-research-v0.4
8. deepseek-ai/DeepSeek-Coder-V2-Lite-Instruct
9. Qwen/Qwen3-Coder-30B-A3B-Instruct
10. alias-code
11. Qwen/Qwen3-Embedding-4B
12. BAAI/bge-reranker-v2-m3
13. stabilityai/stable-diffusion-3.5-large-turbo
14. alias-image-generation
15. black-forest-labs/FLUX.1-dev
16. openai/whisper-large-v3
17. Kokoro-82M
18. tts-1-hd
19. deepseek-ai/DeepSeek-R1
20. openai/gpt-oss-120b
21. meta-llama/Llama-4-Scout-17B-16E-Instruct

ðŸ‘‰ Select a model number (default = 1): 
âœ… Using model: meta-llama/Llama-4-Scout-17B-16E-Instruct

ðŸ” Enter a scientific query or topic: 
ðŸ”Ž Citation Function Classification:
{
  "citation_functions": [
    "Motivation",
    "Extends"
  ],
  "justification": "The query highlights a driving factor behind further research and asks how a discovery builds upon existing knowledge."
}

âœ… Saved to classified_outputs.jsonl
ðŸ”§ Ready for retrieval module (handled in a separate file).
âš¡ SKIP_REINDEX=1 â€” using existing FAISS index + meta; not scanning raw JSONL shards.
âœ… Top-k candidates (FAISS): /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
[14:10:29] main | args: Namespace(max_check=10, debug=True)
[14:10:29] read_last_jsonl | path= classified_outputs.jsonl
[14:10:29] read_last_jsonl | total_lines= 1
[14:10:29] main | query='How does the discovery of high redshift Lyman-$\alpha$ sources motivate and extend our understanding of chemically primitive galaxies in the early universe?' | funcs=['Motivation', 'Extends']
[14:10:31] main | core_terms= ['discovery', 'high', 'redshift', 'lyman', 'alpha', 'sources', 'motivate', 'extend', 'understanding', 'chemically', 'primitive', 'galaxies', 'early', 'universe']
[14:10:31] load_topk_jsonl | path= /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/outputs/topk_candidates_query.jsonl
[14:10:31] load_topk_jsonl | rows= 20
[14:10:31] load_topk_jsonl | first: rank= 0 paper_id= astro-ph/0104308 title_snip='Chemical Enrichment at High Redshifts: Understanding the Nature of
  Dâ€¦' abs_len= 1464
[14:10:31] main | running function= Motivation
[14:10:31] select | function= Motivation | candidates_in= 20
[14:10:31] select | core_terms= ['discovery', 'high', 'redshift', 'lyman', 'alpha', 'sources', 'motivate', 'extend', 'understanding', 'chemically', 'primitive', 'galaxies', 'early', 'universe']
[14:10:31] select | no cosine prune; kept=20/20
[14:10:31] select | pool_size= 10 | ranks= [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] | pids= ['astro-ph/0104308', 'astro-ph/0103485', 'astro-ph/0104466', 'astro-ph/0104294', 'astro-ph/0101174', 'astro-ph/0101544', 'astro-ph/0101407', 'hep-ph/0101162', 'astro-ph/0103048', 'astro-ph/0104237']
[14:10:31] select | verify relaxed 1/10
[14:10:31] verify | func= Motivation | rank= 0 | pid= astro-ph/0104308 | title_snip='Chemical Enrichment at High Redshifts: Understanding the Nature of
  Dâ€¦' | abs_len= 1464
[14:10:34] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= False
[14:10:34] select | verify relaxed 2/10
[14:10:34] verify | func= Motivation | rank= 1 | pid= astro-ph/0103485 | title_snip='Star formation and chemical evolution of damped Lyman $\alpha$ systems' | abs_len= 1606
[14:10:38] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[14:10:38] select | verify relaxed 3/10
[14:10:38] verify | func= Motivation | rank= 2 | pid= astro-ph/0104466 | title_snip='The First Detection of Co in a Damped Lyman Alpha System' | abs_len= 1220
[14:10:41] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= False
[14:10:41] select | verify relaxed 4/10
[14:10:41] verify | func= Motivation | rank= 3 | pid= astro-ph/0104294 | title_snip='The Large Area Lyman Alpha Survey' | abs_len= 1497
[14:10:44] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= False
[14:10:44] select | verify relaxed 5/10
[14:10:44] verify | func= Motivation | rank= 4 | pid= astro-ph/0101174 | title_snip='Extended Lyman Alpha Emission Around Young Quasars: a Constraint on
  â€¦' | abs_len= 1134
[14:10:47] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= False
[14:10:47] select | verify relaxed 6/10
[14:10:47] verify | func= Motivation | rank= 5 | pid= astro-ph/0101544 | title_snip='Dark energy and the epoch of galaxy formation' | abs_len= 971
[14:10:50] verify | result supports= False fit= 0.00 top= 0.20 invalid= â€” cue_hint= False
[14:10:50] select | verify relaxed 7/10
[14:10:50] verify | func= Motivation | rank= 6 | pid= astro-ph/0101407 | title_snip='Chemical Evolution and Starbursts' | abs_len= 629
[14:10:53] verify | result supports= False fit= 0.00 top= 0.50 invalid= â€” cue_hint= False
[14:10:53] select | verify relaxed 8/10
[14:10:53] verify | func= Motivation | rank= 7 | pid= hep-ph/0101162 | title_snip='Probing for the Charm Content of $B$ and $\Upsilon$ Mesons' | abs_len= 652
[14:10:55] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[14:10:55] select | verify relaxed 9/10
[14:10:55] verify | func= Motivation | rank= 8 | pid= astro-ph/0103048 | title_snip='Polarization Insights for Active Galactic Nuclei' | abs_len= 1223
[14:10:58] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[14:10:58] select | verify relaxed 10/10
[14:10:58] verify | func= Motivation | rank= 9 | pid= astro-ph/0104237 | title_snip='Chemical Evolution of Galaxies' | abs_len= 977
[14:11:01] verify | result supports= False fit= 0.00 top= 0.20 invalid= â€” cue_hint= False

================================================================================
FUNCTION: Motivation
QUERY   : How does the discovery of high redshift Lyman-$\alpha$ sources motivate and extend our understanding of chemically primitive galaxies in the early universe?
- WINNER: astro-ph/0104308 | Chemical Enrichment at High Redshifts: Understanding the Nature of
  Damped Ly$\alpha$ Systems in Hierarchical Models
- QUOTE : Chemical Enrichment at High Redshifts
- WHY   : sufficient
[14:11:02] main | running function= Extends
[14:11:02] select | function= Extends | candidates_in= 20
[14:11:02] select | core_terms= ['discovery', 'high', 'redshift', 'lyman', 'alpha', 'sources', 'motivate', 'extend', 'understanding', 'chemically', 'primitive', 'galaxies', 'early', 'universe']
[14:11:02] select | no cosine prune; kept=20/20
[14:11:02] select | pool_size= 10 | ranks= [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] | pids= ['astro-ph/0104308', 'astro-ph/0103485', 'astro-ph/0104466', 'astro-ph/0104294', 'astro-ph/0101174', 'astro-ph/0101544', 'astro-ph/0101407', 'hep-ph/0101162', 'astro-ph/0103048', 'astro-ph/0104237']
[14:11:02] select | verify relaxed 1/10
[14:11:02] verify | func= Extends | rank= 0 | pid= astro-ph/0104308 | title_snip='Chemical Enrichment at High Redshifts: Understanding the Nature of
  Dâ€¦' | abs_len= 1464
[14:11:05] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= False
[14:11:05] select | verify relaxed 2/10
[14:11:05] verify | func= Extends | rank= 1 | pid= astro-ph/0103485 | title_snip='Star formation and chemical evolution of damped Lyman $\alpha$ systems' | abs_len= 1606
[14:11:08] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[14:11:08] select | verify relaxed 3/10
[14:11:08] verify | func= Extends | rank= 2 | pid= astro-ph/0104466 | title_snip='The First Detection of Co in a Damped Lyman Alpha System' | abs_len= 1220
[14:11:12] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= False
[14:11:12] select | verify relaxed 4/10
[14:11:12] verify | func= Extends | rank= 3 | pid= astro-ph/0104294 | title_snip='The Large Area Lyman Alpha Survey' | abs_len= 1497
[14:11:15] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= False
[14:11:15] select | verify relaxed 5/10
[14:11:15] verify | func= Extends | rank= 4 | pid= astro-ph/0101174 | title_snip='Extended Lyman Alpha Emission Around Young Quasars: a Constraint on
  â€¦' | abs_len= 1134
[14:11:18] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= True
[14:11:18] select | verify relaxed 6/10
[14:11:18] verify | func= Extends | rank= 5 | pid= astro-ph/0101544 | title_snip='Dark energy and the epoch of galaxy formation' | abs_len= 971
[14:11:21] verify | result supports= False fit= 0.00 top= 0.20 invalid= â€” cue_hint= False
[14:11:21] select | verify relaxed 7/10
[14:11:21] verify | func= Extends | rank= 6 | pid= astro-ph/0101407 | title_snip='Chemical Evolution and Starbursts' | abs_len= 629
[14:11:24] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= False
[14:11:24] select | verify relaxed 8/10
[14:11:24] verify | func= Extends | rank= 7 | pid= hep-ph/0101162 | title_snip='Probing for the Charm Content of $B$ and $\Upsilon$ Mesons' | abs_len= 652
[14:11:26] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[14:11:26] select | verify relaxed 9/10
[14:11:26] verify | func= Extends | rank= 8 | pid= astro-ph/0103048 | title_snip='Polarization Insights for Active Galactic Nuclei' | abs_len= 1223
[14:11:29] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[14:11:29] select | verify relaxed 10/10
[14:11:29] verify | func= Extends | rank= 9 | pid= astro-ph/0104237 | title_snip='Chemical Evolution of Galaxies' | abs_len= 977
[14:11:32] verify | result supports= False fit= 0.00 top= 0.50 invalid= â€” cue_hint= False

================================================================================
FUNCTION: Extends
QUERY   : How does the discovery of high redshift Lyman-$\alpha$ sources motivate and extend our understanding of chemically primitive galaxies in the early universe?
- WINNER: astro-ph/0101174 | Extended Lyman Alpha Emission Around Young Quasars: a Constraint on
  Galaxy Formation
- QUOTE : extended Lyman alpha emission
- WHY   : sufficient

================================================================================
UNIFIED ANSWER (1â€“2 sentences, tagged):
The discovery of high redshift Lyman-$\alpha$ sources motivates the study of chemically primitive galaxies in the early universe by providing insights into the chemical properties of galaxy-like objects at high redshift [Motivation] (astro-ph/0104308). This discovery extends our understanding of galaxy formation by suggesting that extended Lyman alpha emission around young quasars can constrain models of galaxy formation and provide insights into the distribution of infalling cold gas [Extends] (astro-ph/0101174).

ðŸ“„ Saved: outputs/function_selection_results.json
ðŸ“„ Saved: outputs/function_selection_results.jsonl
ðŸ“ Unified answer: outputs/function_answer_unified.txt
-> /home/anpa439f/anaconda3/envs/myenv/bin/python3 /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/classifying_question.py  (cwd=/data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration)
âœ… Saved to classified_outputs.jsonl
ðŸ”§ Ready for retrieval module (.py).
-> /home/anpa439f/anaconda3/envs/myenv/bin/python3 /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/Retreival_query_based.py --skip-reindex --index /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/e5_index_subset_1/index.faiss --meta /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/e5_index_subset_1/meta.parquet --topk 20  (cwd=/data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration)
âœ… Top-k candidates: /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
ðŸ”— Symlinked: /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/outputs/topk_candidates_query.jsonl -> /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
-> /home/anpa439f/anaconda3/envs/myenv/bin/python3 /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/function_based_answer-2_copy.py --debug --max-check 10  (cwd=/data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration)

ðŸŽ‰ Pipeline complete.
  â€¢ Classified file : /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/classified_outputs.jsonl
  â€¢ TopK (canonical): /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
  â€¢ Final outputs   : /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs
