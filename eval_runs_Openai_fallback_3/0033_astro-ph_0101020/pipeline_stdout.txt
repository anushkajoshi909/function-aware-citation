âœ… Available Models:
1. alias-reasoning
2. alias-ha
3. meta-llama/Llama-3.3-70B-Instruct
4. meta-llama/Llama-3.1-8B-Instruct
5. Qwen/Qwen2-VL-7B-Instruct
6. alias-vision
7. openGPT-X/Teuken-7B-instruct-research-v0.4
8. deepseek-ai/DeepSeek-Coder-V2-Lite-Instruct
9. Qwen/Qwen3-Coder-30B-A3B-Instruct
10. alias-code
11. Qwen/Qwen3-Embedding-4B
12. BAAI/bge-reranker-v2-m3
13. stabilityai/stable-diffusion-3.5-large-turbo
14. alias-image-generation
15. black-forest-labs/FLUX.1-dev
16. openai/whisper-large-v3
17. Kokoro-82M
18. tts-1-hd
19. deepseek-ai/DeepSeek-R1
20. openai/gpt-oss-120b
21. meta-llama/Llama-4-Scout-17B-16E-Instruct

ðŸ‘‰ Select a model number (default = 1): 
âœ… Using model: openai/gpt-oss-120b

ðŸ” Enter a scientific query or topic: 
ðŸ”Ž Citation Function Classification:
{
  "citation_functions": [
    "Background",
    "Motivation"
  ],
  "justification": "The query asks for foundational information about the two\u2011fluid model (background) and why it is relevant for explaining energetic cosmic\u2011ray production (motivation)."
}

âœ… Saved to classified_outputs.jsonl
ðŸ”§ Ready for retrieval module (handled in a separate file).
âš¡ SKIP_REINDEX=1 â€” using existing FAISS index + meta; not scanning raw JSONL shards.
âœ… Top-k candidates (FAISS): /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
[21:49:48] main | args: Namespace(max_check=10, debug=True)
[21:49:48] read_last_jsonl | path= classified_outputs.jsonl
[21:49:48] read_last_jsonl | total_lines= 1
[21:49:48] main | query='How does the two-fluid model of diffusive shock acceleration, which this work uses, provide background information for understanding the production of energetic cosmic rays?' | funcs=['Background', 'Motivation']
[21:49:50] main | core_terms= ['cosmic rays', 'diffusive shock acceleration', 'two-fluid model', 'two-fluid']
[21:49:50] load_topk_jsonl | path= /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/outputs/topk_candidates_query.jsonl
[21:49:50] load_topk_jsonl | rows= 20
[21:49:50] load_topk_jsonl | first: rank= 0 paper_id= astro-ph/0101020 title_snip='Exact Expressions for the Critical Mach Numbers in the Two-Fluid Modelâ€¦' abs_len= 1318
[21:49:50] main | running function= Background
[21:49:50] select | function= Background | candidates_in= 20
[21:49:50] select | core_terms= ['cosmic rays', 'diffusive shock acceleration', 'two-fluid model', 'two-fluid']
[21:49:50] select | no cosine prune; kept=20/20
[21:49:50] select | pool_size= 10 | ranks= [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] | pids= ['astro-ph/0101020', 'astro-ph/0104064', 'astro-ph/0104120', 'astro-ph/0101245', 'astro-ph/0101053', 'hep-ex/0101049', 'astro-ph/0101331', 'astro-ph/0101175', 'hep-ph/0101184', 'astro-ph/0103108']
[21:49:50] select | verify relaxed 1/10
[21:49:50] verify | func= Background | rank= 0 | pid= astro-ph/0101020 | title_snip='Exact Expressions for the Critical Mach Numbers in the Two-Fluid Modelâ€¦' | abs_len= 1318
[21:49:53] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= False
[21:49:53] select | verify relaxed 2/10
[21:49:53] verify | func= Background | rank= 1 | pid= astro-ph/0104064 | title_snip='A semi-analytical approach to non-linear shock acceleration' | abs_len= 1113
[21:49:58] verify | result supports= False fit= 0.00 top= 0.90 invalid= off_topic_no_core_in_abstract cue_hint= False
[21:49:58] select | verify relaxed 3/10
[21:49:58] verify | func= Background | rank= 2 | pid= astro-ph/0104120 | title_snip='Numerical Simulations of Relativistic Shock Acceleration' | abs_len= 1002
[21:50:01] verify | result supports= False fit= 0.00 top= 0.90 invalid= off_topic_no_core_in_abstract cue_hint= False
[21:50:01] select | verify relaxed 4/10
[21:50:01] verify | func= Background | rank= 3 | pid= astro-ph/0101245 | title_snip='Particle Energy And Acceleration Efficiencies In Highly Relativistic
 â€¦' | abs_len= 1245
[21:50:05] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= False
[21:50:05] select | verify relaxed 5/10
[21:50:05] verify | func= Background | rank= 4 | pid= astro-ph/0101053 | title_snip='Mechanisms and sites of ultra high energy cosmic ray origin' | abs_len= 954
[21:50:08] verify | result supports= False fit= 0.00 top= 0.80 invalid= â€” cue_hint= False
[21:50:08] select | verify relaxed 6/10
[21:50:08] verify | func= Background | rank= 5 | pid= hep-ex/0101049 | title_snip='Predicting Neutron Production from Cosmic-ray Muons' | abs_len= 746
[21:50:11] verify | result supports= False fit= 0.00 top= 0.20 invalid= â€” cue_hint= False
[21:50:11] select | verify relaxed 7/10
[21:50:11] verify | func= Background | rank= 6 | pid= astro-ph/0101331 | title_snip='Cosmic Rays and Particle Physics' | abs_len= 774
[21:50:14] verify | result supports= False fit= 0.00 top= 0.50 invalid= â€” cue_hint= False
[21:50:14] select | verify relaxed 8/10
[21:50:14] verify | func= Background | rank= 7 | pid= astro-ph/0101175 | title_snip='Shock Acceleration of Cosmic Rays - a critical review' | abs_len= 799
[21:50:17] verify | result supports= False fit= 0.00 top= 0.80 invalid= no_quote cue_hint= False
[21:50:17] select | verify relaxed 9/10
[21:50:17] verify | func= Background | rank= 8 | pid= hep-ph/0101184 | title_snip='Study of two-photon production process in proton-proton collisions belâ€¦' | abs_len= 919
[21:50:20] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[21:50:20] select | verify relaxed 10/10
[21:50:20] verify | func= Background | rank= 9 | pid= astro-ph/0103108 | title_snip='Radiative Hydromagnetic Shocks in Relativistic Outflow Sources' | abs_len= 1788
[21:50:23] verify | result supports= False fit= 0.00 top= 0.20 invalid= no_quote cue_hint= False

================================================================================
FUNCTION: Background
QUERY   : How does the two-fluid model of diffusive shock acceleration, which this work uses, provide background information for understanding the production of energetic cosmic rays?
- WINNER: astro-ph/0101020 | Exact Expressions for the Critical Mach Numbers in the Two-Fluid Model
  of Cosmic-Ray Modified Shocks
- QUOTE : using the ``two-fluid'' model of diffusive shock acceleration
- WHY   : sufficient
[21:50:24] main | running function= Motivation
[21:50:24] select | function= Motivation | candidates_in= 20
[21:50:24] select | core_terms= ['cosmic rays', 'diffusive shock acceleration', 'two-fluid model', 'two-fluid']
[21:50:24] select | no cosine prune; kept=20/20
[21:50:24] select | pool_size= 10 | ranks= [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] | pids= ['astro-ph/0101020', 'astro-ph/0104064', 'astro-ph/0104120', 'astro-ph/0101245', 'astro-ph/0101053', 'hep-ex/0101049', 'astro-ph/0101331', 'astro-ph/0101175', 'hep-ph/0101184', 'astro-ph/0103108']
[21:50:24] select | verify relaxed 1/10
[21:50:24] verify | func= Motivation | rank= 0 | pid= astro-ph/0101020 | title_snip='Exact Expressions for the Critical Mach Numbers in the Two-Fluid Modelâ€¦' | abs_len= 1318
[21:50:28] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= False
[21:50:28] select | verify relaxed 2/10
[21:50:28] verify | func= Motivation | rank= 1 | pid= astro-ph/0104064 | title_snip='A semi-analytical approach to non-linear shock acceleration' | abs_len= 1113
[21:50:31] verify | result supports= False fit= 0.00 top= 0.80 invalid= â€” cue_hint= False
[21:50:31] select | verify relaxed 3/10
[21:50:31] verify | func= Motivation | rank= 2 | pid= astro-ph/0104120 | title_snip='Numerical Simulations of Relativistic Shock Acceleration' | abs_len= 1002
[21:50:34] verify | result supports= False fit= 0.00 top= 0.80 invalid= â€” cue_hint= False
[21:50:34] select | verify relaxed 4/10
[21:50:34] verify | func= Motivation | rank= 3 | pid= astro-ph/0101245 | title_snip='Particle Energy And Acceleration Efficiencies In Highly Relativistic
 â€¦' | abs_len= 1245
[21:50:38] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= False
[21:50:38] select | verify relaxed 5/10
[21:50:38] verify | func= Motivation | rank= 4 | pid= astro-ph/0101053 | title_snip='Mechanisms and sites of ultra high energy cosmic ray origin' | abs_len= 954
[21:50:41] verify | result supports= False fit= 0.00 top= 0.80 invalid= â€” cue_hint= False
[21:50:41] select | verify relaxed 6/10
[21:50:41] verify | func= Motivation | rank= 5 | pid= hep-ex/0101049 | title_snip='Predicting Neutron Production from Cosmic-ray Muons' | abs_len= 746
[21:50:44] verify | result supports= False fit= 0.00 top= 0.20 invalid= â€” cue_hint= False
[21:50:44] select | verify relaxed 7/10
[21:50:44] verify | func= Motivation | rank= 6 | pid= astro-ph/0101331 | title_snip='Cosmic Rays and Particle Physics' | abs_len= 774
[21:50:48] verify | result supports= False fit= 0.00 top= 0.80 invalid= â€” cue_hint= False
[21:50:48] select | verify relaxed 8/10
[21:50:48] verify | func= Motivation | rank= 7 | pid= astro-ph/0101175 | title_snip='Shock Acceleration of Cosmic Rays - a critical review' | abs_len= 799
[21:50:51] verify | result supports= False fit= 0.00 top= 0.90 invalid= off_topic_no_core_in_abstract cue_hint= True
[21:50:51] select | verify relaxed 9/10
[21:50:51] verify | func= Motivation | rank= 8 | pid= hep-ph/0101184 | title_snip='Study of two-photon production process in proton-proton collisions belâ€¦' | abs_len= 919
[21:50:54] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[21:50:54] select | verify relaxed 10/10
[21:50:54] verify | func= Motivation | rank= 9 | pid= astro-ph/0103108 | title_snip='Radiative Hydromagnetic Shocks in Relativistic Outflow Sources' | abs_len= 1788
[21:50:57] verify | result supports= False fit= 0.00 top= 0.20 invalid= no_quote cue_hint= False

================================================================================
FUNCTION: Motivation
QUERY   : How does the two-fluid model of diffusive shock acceleration, which this work uses, provide background information for understanding the production of energetic cosmic rays?
- WINNER: astro-ph/0101020 | Exact Expressions for the Critical Mach Numbers in the Two-Fluid Model
  of Cosmic-Ray Modified Shocks
- QUOTE : The acceleration of relativistic particles due to repeated scattering
- WHY   : sufficient

================================================================================
UNIFIED ANSWER (1â€“2 sentences, tagged):
The two-fluid model of diffusive shock acceleration provides background information for understanding the production of energetic cosmic rays by analyzing the acceleration of relativistic particles due to repeated scattering across a shock wave [Background] (astro-ph/0101020). The motivation for using this model stems from its ability to explain the production of energetic cosmic rays through the acceleration process, which has been extensively analyzed over the past two decades [Motivation] (astro-ph/0101020).

ðŸ“„ Saved: outputs/function_selection_results.json
ðŸ“„ Saved: outputs/function_selection_results.jsonl
ðŸ“ Unified answer: outputs/function_answer_unified.txt
-> /home/anpa439f/anaconda3/envs/myenv/bin/python3 /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/classifying_question.py  (cwd=/data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration)
âœ… Saved to classified_outputs.jsonl
ðŸ”§ Ready for retrieval module (.py).
-> /home/anpa439f/anaconda3/envs/myenv/bin/python3 /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/Retreival_query_based.py --skip-reindex --index /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/e5_index_subset_1/index.faiss --meta /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/e5_index_subset_1/meta.parquet --topk 20  (cwd=/data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration)
âœ… Top-k candidates: /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
ðŸ”— Symlinked: /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/outputs/topk_candidates_query.jsonl -> /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
-> /home/anpa439f/anaconda3/envs/myenv/bin/python3 /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/function_based_answer-2_copy.py --debug --max-check 10  (cwd=/data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration)

ðŸŽ‰ Pipeline complete.
  â€¢ Classified file : /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/classified_outputs.jsonl
  â€¢ TopK (canonical): /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
  â€¢ Final outputs   : /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs
