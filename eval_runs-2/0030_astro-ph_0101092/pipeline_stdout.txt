âœ… Available Models:
1. alias-code
2. alias-reasoning
3. alias-image-generation
4. alias-vision
5. alias-ha
6. meta-llama/Llama-3.3-70B-Instruct
7. meta-llama/Llama-3.1-8B-Instruct
8. Qwen/Qwen2-VL-7B-Instruct
9. openGPT-X/Teuken-7B-instruct-research-v0.4
10. deepseek-ai/DeepSeek-Coder-V2-Lite-Instruct
11. Qwen/Qwen3-Coder-30B-A3B-Instruct
12. Qwen/Qwen3-Embedding-4B
13. stabilityai/stable-diffusion-3.5-large-turbo
14. black-forest-labs/FLUX.1-dev
15. openai/whisper-large-v3
16. Kokoro-82M
17. tts-1-hd
18. deepseek-ai/DeepSeek-R1
19. openai/gpt-oss-120b
20. meta-llama/Llama-4-Scout-17B-16E-Instruct

ðŸ‘‰ Select a model number (default = 1): 
âœ… Using model: openai/gpt-oss-120b

ðŸ” Enter a scientific query or topic: 
ðŸ”Ž Citation Function Classification:
{
  "citation_functions": [
    "Motivation",
    "Uses"
  ],
  "justification": "The query seeks the reasons driving spectroscopic studies of microlensed sources (Motivation) and asks about the methods or datasets employed (Uses)."
}

âœ… Saved to classified_outputs.jsonl
ðŸ”§ Ready for retrieval module (handled in a separate file).
âš¡ SKIP_REINDEX=1 â€” using existing FAISS index + meta; not scanning raw JSONL shards.
âœ… Top-k candidates (FAISS): /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
[21:54:03] main | args: Namespace(max_check=10, debug=True)
[21:54:03] read_last_jsonl | path= classified_outputs.jsonl
[21:54:03] read_last_jsonl | total_lines= 1
[21:54:03] main | query='What motivates the spectroscopic study of microlensed sources and what methods or datasets does it use to achieve its goals?' | funcs=['Motivation', 'Uses']
[21:54:04] main | core_terms= ['microlensed sources', 'spectroscopy']
[21:54:04] load_topk_jsonl | path= /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/outputs/topk_candidates_query.jsonl
[21:54:05] load_topk_jsonl | rows= 20
[21:54:05] load_topk_jsonl | first: rank= 0 paper_id= astro-ph/0101092 title_snip='Studying the Galactic Bulge Through Spectroscopy of Microlensed Sourceâ€¦' abs_len= 1127
[21:54:05] main | running function= Motivation
[21:54:05] select | function= Motivation | candidates_in= 20
[21:54:05] select | core_terms= ['microlensed sources', 'spectroscopy']
[21:54:05] select | no cosine prune; kept=20/20
[21:54:05] select | pool_size= 10 | ranks= [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] | pids= ['astro-ph/0101092', 'astro-ph/0103516', 'gr-qc/0104076', 'astro-ph/0102013', 'astro-ph/0101378', 'astro-ph/0102257', 'astro-ph/0102242', 'astro-ph/0102031', 'astro-ph/0101428', 'astro-ph/0104283']
[21:54:05] select | verify relaxed 1/10
[21:54:05] verify | func= Motivation | rank= 0 | pid= astro-ph/0101092 | title_snip='Studying the Galactic Bulge Through Spectroscopy of Microlensed Sourceâ€¦' | abs_len= 1127
[21:54:07] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= False
[21:54:07] select | verify relaxed 2/10
[21:54:07] verify | func= Motivation | rank= 1 | pid= astro-ph/0103516 | title_snip='Applications of Microlensing to Stellar Astrophysics' | abs_len= 1616
[21:54:11] verify | result supports= False fit= 0.00 top= 0.90 invalid= off_topic_no_core_in_abstract cue_hint= False
[21:54:11] select | verify relaxed 3/10
[21:54:11] verify | func= Motivation | rank= 2 | pid= gr-qc/0104076 | title_snip='Chromaticity effects in microlensing by wormholes' | abs_len= 368
[21:54:14] verify | result supports= False fit= 0.00 top= 0.90 invalid= off_topic_no_core_in_abstract cue_hint= False
[21:54:14] select | verify relaxed 4/10
[21:54:14] verify | func= Motivation | rank= 3 | pid= astro-ph/0102013 | title_snip='The Sagittarius dwarf galaxy as a microlensing target' | abs_len= 1133
[21:54:17] verify | result supports= False fit= 0.00 top= 0.90 invalid= off_topic_no_core_in_abstract cue_hint= False
[21:54:17] select | verify relaxed 5/10
[21:54:17] verify | func= Motivation | rank= 4 | pid= astro-ph/0101378 | title_snip='A database of high and medium-resolution stellar spectra' | abs_len= 1012
[21:54:19] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[21:54:19] select | verify relaxed 6/10
[21:54:19] verify | func= Motivation | rank= 5 | pid= astro-ph/0102257 | title_snip='Gravitational microlensing of planets: the influence of planetary phasâ€¦' | abs_len= 1384
[21:54:22] verify | result supports= False fit= 0.00 top= 0.50 invalid= no_quote cue_hint= False
[21:54:22] select | verify relaxed 7/10
[21:54:22] verify | func= Motivation | rank= 6 | pid= astro-ph/0102242 | title_snip='Detecting Galactic MACHOs with VERA through Astrometric Microlensing oâ€¦' | abs_len= 1755
[21:54:25] verify | result supports= False fit= 0.00 top= 0.50 invalid= no_quote cue_hint= False
[21:54:25] select | verify relaxed 8/10
[21:54:25] verify | func= Motivation | rank= 7 | pid= astro-ph/0102031 | title_snip='On calculation of microlensing light curve by gravitational lens caustâ€¦' | abs_len= 795
[21:54:28] verify | result supports= False fit= 0.00 top= 0.50 invalid= â€” cue_hint= False
[21:54:28] select | verify relaxed 9/10
[21:54:28] verify | func= Motivation | rank= 8 | pid= astro-ph/0101428 | title_snip='Automated spectral extraction for high multiplexing MOS and IFU
  obseâ€¦' | abs_len= 1229
[21:54:30] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[21:54:30] select | verify relaxed 10/10
[21:54:30] verify | func= Motivation | rank= 9 | pid= astro-ph/0104283 | title_snip='WeCAPP - The Wendelstein Calar Alto Pixellensing Project I Tracing Darâ€¦' | abs_len= 805
[21:54:33] verify | result supports= False fit= 0.00 top= 0.50 invalid= â€” cue_hint= False

================================================================================
FUNCTION: Motivation
QUERY   : What motivates the spectroscopic study of microlensed sources and what methods or datasets does it use to achieve its goals?
- WINNER: astro-ph/0101092 | Studying the Galactic Bulge Through Spectroscopy of Microlensed Sources:
  II. Observations
- QUOTE : unique opportunity to study
- WHY   : sufficient
- ANSWER: The study of microlensed sources through spectroscopy is motivated by the need to understand the kinematics of the Galactic bulge and the effects of extinction on these sources. It uses spectroscopic observations from the ESO Faint Object Spectrograph to derive radial velocities and extinctions of microlensed sources (astro-ph/0101092).
[21:54:38] main | running function= Uses
[21:54:38] select | function= Uses | candidates_in= 20
[21:54:38] select | core_terms= ['microlensed sources', 'spectroscopy']
[21:54:38] select | no cosine prune; kept=20/20
[21:54:38] select | pool_size= 10 | ranks= [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] | pids= ['astro-ph/0101092', 'astro-ph/0103516', 'gr-qc/0104076', 'astro-ph/0102013', 'astro-ph/0101378', 'astro-ph/0102257', 'astro-ph/0102242', 'astro-ph/0102031', 'astro-ph/0101428', 'astro-ph/0104283']
[21:54:38] select | verify relaxed 1/10
[21:54:38] verify | func= Uses | rank= 0 | pid= astro-ph/0101092 | title_snip='Studying the Galactic Bulge Through Spectroscopy of Microlensed Sourceâ€¦' | abs_len= 1127
[21:54:42] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= True
[21:54:42] select | verify relaxed 2/10
[21:54:42] verify | func= Uses | rank= 1 | pid= astro-ph/0103516 | title_snip='Applications of Microlensing to Stellar Astrophysics' | abs_len= 1616
[21:54:45] verify | result supports= False fit= 0.20 top= 0.80 invalid= â€” cue_hint= False
[21:54:45] select | verify relaxed 3/10
[21:54:45] verify | func= Uses | rank= 2 | pid= gr-qc/0104076 | title_snip='Chromaticity effects in microlensing by wormholes' | abs_len= 368
[21:54:48] verify | result supports= False fit= 0.20 top= 0.80 invalid= â€” cue_hint= False
[21:54:48] select | verify relaxed 4/10
[21:54:48] verify | func= Uses | rank= 3 | pid= astro-ph/0102013 | title_snip='The Sagittarius dwarf galaxy as a microlensing target' | abs_len= 1133
[21:54:51] verify | result supports= False fit= 0.00 top= 0.80 invalid= no_quote cue_hint= False
[21:54:51] select | verify relaxed 5/10
[21:54:51] verify | func= Uses | rank= 4 | pid= astro-ph/0101378 | title_snip='A database of high and medium-resolution stellar spectra' | abs_len= 1012
[21:54:53] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[21:54:53] select | verify relaxed 6/10
[21:54:53] verify | func= Uses | rank= 5 | pid= astro-ph/0102257 | title_snip='Gravitational microlensing of planets: the influence of planetary phasâ€¦' | abs_len= 1384
[21:54:56] verify | result supports= False fit= 0.00 top= 0.50 invalid= no_quote cue_hint= False
[21:54:56] select | verify relaxed 7/10
[21:54:56] verify | func= Uses | rank= 6 | pid= astro-ph/0102242 | title_snip='Detecting Galactic MACHOs with VERA through Astrometric Microlensing oâ€¦' | abs_len= 1755
[21:54:58] verify | result supports= False fit= 0.00 top= 0.20 invalid= no_quote cue_hint= False
[21:54:58] select | verify relaxed 8/10
[21:54:58] verify | func= Uses | rank= 7 | pid= astro-ph/0102031 | title_snip='On calculation of microlensing light curve by gravitational lens caustâ€¦' | abs_len= 795
[21:55:01] verify | result supports= False fit= 0.00 top= 0.50 invalid= â€” cue_hint= False
[21:55:01] select | verify relaxed 9/10
[21:55:01] verify | func= Uses | rank= 8 | pid= astro-ph/0101428 | title_snip='Automated spectral extraction for high multiplexing MOS and IFU
  obseâ€¦' | abs_len= 1229
[21:55:04] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[21:55:04] select | verify relaxed 10/10
[21:55:04] verify | func= Uses | rank= 9 | pid= astro-ph/0104283 | title_snip='WeCAPP - The Wendelstein Calar Alto Pixellensing Project I Tracing Darâ€¦' | abs_len= 805
[21:55:07] verify | result supports= False fit= 0.00 top= 0.50 invalid= â€” cue_hint= False

================================================================================
FUNCTION: Uses
QUERY   : What motivates the spectroscopic study of microlensed sources and what methods or datasets does it use to achieve its goals?
- WINNER: astro-ph/0101092 | Studying the Galactic Bulge Through Spectroscopy of Microlensed Sources:
  II. Observations
- QUOTE : using the ESO Faint Object Spectrograph (EFOSC) at the 3.6 m European Southern Observatory (ESO) telescope
- WHY   : sufficient
- ANSWER: The spectroscopic study of microlensed sources is motivated by the opportunity to study the Galactic bulge's kinematics and extinction effects. Researchers use the ESO Faint Object Spectrograph and Kurucz model spectra to derive radial velocities and extinctions of microlensed sources (astro-ph/0101092).

ðŸ“„ Saved: outputs/function_selection_results.json
ðŸ“„ Saved: outputs/function_selection_results.jsonl
ðŸ“ Answers-only: outputs/function_answers.txt
-> /home/anpa439f/anaconda3/envs/myenv/bin/python3 /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/classifying_question.py  (cwd=/data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration)
âœ… Saved to classified_outputs.jsonl
ðŸ”§ Ready for retrieval module (.py).
-> /home/anpa439f/anaconda3/envs/myenv/bin/python3 /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/Retreival_query_based.py --skip-reindex --index /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/e5_index_subset_1/index.faiss --meta /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/e5_index_subset_1/meta.parquet --topk 20  (cwd=/data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration)
âœ… Top-k candidates: /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
ðŸ”— Symlinked: /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/outputs/topk_candidates_query.jsonl -> /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
-> /home/anpa439f/anaconda3/envs/myenv/bin/python3 /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/function_based_answer-2.py --debug --max-check 10  (cwd=/data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration)

ðŸŽ‰ Pipeline complete.
  â€¢ Classified file : /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/classified_outputs.jsonl
  â€¢ TopK (canonical): /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
  â€¢ Final outputs   : /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs
