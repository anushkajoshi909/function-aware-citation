âœ… Available Models:
1. alias-code
2. alias-reasoning
3. alias-image-generation
4. alias-vision
5. alias-ha
6. meta-llama/Llama-3.3-70B-Instruct
7. meta-llama/Llama-3.1-8B-Instruct
8. Qwen/Qwen2-VL-7B-Instruct
9. openGPT-X/Teuken-7B-instruct-research-v0.4
10. deepseek-ai/DeepSeek-Coder-V2-Lite-Instruct
11. Qwen/Qwen3-Coder-30B-A3B-Instruct
12. Qwen/Qwen3-Embedding-4B
13. stabilityai/stable-diffusion-3.5-large-turbo
14. black-forest-labs/FLUX.1-dev
15. openai/whisper-large-v3
16. Kokoro-82M
17. tts-1-hd
18. deepseek-ai/DeepSeek-R1
19. openai/gpt-oss-120b
20. meta-llama/Llama-4-Scout-17B-16E-Instruct

ðŸ‘‰ Select a model number (default = 1): 
âœ… Using model: openai/gpt-oss-120b

ðŸ” Enter a scientific query or topic: 
ðŸ”Ž Citation Function Classification:
{
  "citation_functions": [
    "Extends",
    "Background"
  ],
  "justification": "The query asks how a new calculation builds on (extends) prior knowledge, while also referencing the foundational context of the Complex of Local Interstellar Clouds (background)."
}

âœ… Saved to classified_outputs.jsonl
ðŸ”§ Ready for retrieval module (handled in a separate file).
âš¡ SKIP_REINDEX=1 â€” using existing FAISS index + meta; not scanning raw JSONL shards.
âœ… Top-k candidates (FAISS): /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
[23:02:35] main | args: Namespace(max_check=10, debug=True)
[23:02:35] read_last_jsonl | path= classified_outputs.jsonl
[23:02:35] read_last_jsonl | total_lines= 1
[23:02:35] main | query='How does the new calculation of photoionization of interstellar matter build upon existing knowledge of the Complex of Local Interstellar Clouds?' | funcs=['Extends', 'Background']
[23:02:36] main | core_terms= ['interstellar matter', 'Complex of Local Interstellar Clouds', 'photoionization']
[23:02:36] load_topk_jsonl | path= /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/outputs/topk_candidates_query.jsonl
[23:02:36] load_topk_jsonl | rows= 20
[23:02:36] load_topk_jsonl | first: rank= 0 paper_id= astro-ph/0104234 title_snip='The Ionization of Nearby Interstellar Gas' abs_len= 1404
[23:02:36] main | running function= Extends
[23:02:36] select | function= Extends | candidates_in= 20
[23:02:36] select | core_terms= ['interstellar matter', 'Complex of Local Interstellar Clouds', 'photoionization']
[23:02:36] select | no cosine prune; kept=20/20
[23:02:36] select | pool_size= 10 | ranks= [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] | pids= ['astro-ph/0104234', 'astro-ph/0103246', 'astro-ph/0102392', 'astro-ph/0102477', 'astro-ph/0102010', 'astro-ph/0102401', 'hep-ph/0102108', 'astro-ph/0101330', 'astro-ph/0101466', 'astro-ph/0101467']
[23:02:36] select | verify relaxed 1/10
[23:02:36] verify | func= Extends | rank= 0 | pid= astro-ph/0104234 | title_snip='The Ionization of Nearby Interstellar Gas' | abs_len= 1404
[23:02:40] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= False
[23:02:40] select | verify relaxed 2/10
[23:02:40] verify | func= Extends | rank= 1 | pid= astro-ph/0103246 | title_snip='The Spin Temperature of Warm Interstellar H I' | abs_len= 850
[23:02:43] verify | result supports= False fit= 0.00 top= 0.50 invalid= â€” cue_hint= False
[23:02:43] select | verify relaxed 3/10
[23:02:43] verify | func= Extends | rank= 2 | pid= astro-ph/0102392 | title_snip='When Photoionization Is Not Enough' | abs_len= 647
[23:02:46] verify | result supports= False fit= 0.00 top= 0.50 invalid= â€” cue_hint= False
[23:02:46] select | verify relaxed 4/10
[23:02:46] verify | func= Extends | rank= 3 | pid= astro-ph/0102477 | title_snip='The Structure and Evolution of Magnetized Cloud Cores in a Zero--Densiâ€¦' | abs_len= 1571
[23:02:48] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[23:02:48] select | verify relaxed 5/10
[23:02:48] verify | func= Extends | rank= 4 | pid= astro-ph/0102010 | title_snip='New Light on the Baryon Fraction in Galaxy Clusters' | abs_len= 1661
[23:02:51] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[23:02:51] select | verify relaxed 6/10
[23:02:51] verify | func= Extends | rank= 5 | pid= astro-ph/0102401 | title_snip='A Jet Model With a Hard Electron Distribution for the Afterglow of GRBâ€¦' | abs_len= 1111
[23:02:53] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[23:02:53] select | verify relaxed 7/10
[23:02:53] verify | func= Extends | rank= 6 | pid= hep-ph/0102108 | title_snip='An obvious isospin breaking correction to epsilon' of kinematical origâ€¦' | abs_len= 666
[23:02:56] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[23:02:56] select | verify relaxed 8/10
[23:02:56] verify | func= Extends | rank= 7 | pid= astro-ph/0101330 | title_snip='Accretion Processes in the Nucleus of M31' | abs_len= 1631
[23:02:58] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[23:02:58] select | verify relaxed 9/10
[23:02:58] verify | func= Extends | rank= 8 | pid= astro-ph/0101466 | title_snip='On the Distribution of X-ray Surface Brightness from Diffuse Gas' | abs_len= 1212
[23:03:00] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[23:03:00] select | verify relaxed 10/10
[23:03:00] verify | func= Extends | rank= 9 | pid= astro-ph/0101467 | title_snip='The X-ray surface brightness distribution from diffuse gas' | abs_len= 1509
[23:03:03] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False

================================================================================
FUNCTION: Extends
QUERY   : How does the new calculation of photoionization of interstellar matter build upon existing knowledge of the Complex of Local Interstellar Clouds?
- WINNER: astro-ph/0104234 | The Ionization of Nearby Interstellar Gas
- QUOTE : new calculations of the photoionization of interstellar matter
- WHY   : sufficient
- ANSWER: The new calculation of photoionization of interstellar matter extends existing knowledge by incorporating directly observed radiation sources and modeling unobserved EUV emission to improve the accuracy of ionization and heating predictions within the Complex of Local Interstellar Clouds. This approach builds upon prior methods by including additional radiation sources and improving agreement with observational data on temperature, electron density, and gas phase abundances (astro-ph/0104234).
[23:03:08] main | running function= Background
[23:03:08] select | function= Background | candidates_in= 20
[23:03:08] select | core_terms= ['interstellar matter', 'Complex of Local Interstellar Clouds', 'photoionization']
[23:03:08] select | no cosine prune; kept=20/20
[23:03:08] select | pool_size= 10 | ranks= [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] | pids= ['astro-ph/0104234', 'astro-ph/0103246', 'astro-ph/0102392', 'astro-ph/0102477', 'astro-ph/0102010', 'astro-ph/0102401', 'hep-ph/0102108', 'astro-ph/0101330', 'astro-ph/0101466', 'astro-ph/0101467']
[23:03:08] select | verify relaxed 1/10
[23:03:08] verify | func= Background | rank= 0 | pid= astro-ph/0104234 | title_snip='The Ionization of Nearby Interstellar Gas' | abs_len= 1404
[23:03:11] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= False
[23:03:11] select | verify relaxed 2/10
[23:03:11] verify | func= Background | rank= 1 | pid= astro-ph/0103246 | title_snip='The Spin Temperature of Warm Interstellar H I' | abs_len= 850
[23:03:15] verify | result supports= False fit= 0.00 top= 0.50 invalid= â€” cue_hint= False
[23:03:15] select | verify relaxed 3/10
[23:03:15] verify | func= Background | rank= 2 | pid= astro-ph/0102392 | title_snip='When Photoionization Is Not Enough' | abs_len= 647
[23:03:18] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= False
[23:03:18] select | verify relaxed 4/10
[23:03:18] verify | func= Background | rank= 3 | pid= astro-ph/0102477 | title_snip='The Structure and Evolution of Magnetized Cloud Cores in a Zero--Densiâ€¦' | abs_len= 1571
[23:03:20] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[23:03:20] select | verify relaxed 5/10
[23:03:20] verify | func= Background | rank= 4 | pid= astro-ph/0102010 | title_snip='New Light on the Baryon Fraction in Galaxy Clusters' | abs_len= 1661
[23:03:23] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[23:03:23] select | verify relaxed 6/10
[23:03:23] verify | func= Background | rank= 5 | pid= astro-ph/0102401 | title_snip='A Jet Model With a Hard Electron Distribution for the Afterglow of GRBâ€¦' | abs_len= 1111
[23:03:25] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[23:03:25] select | verify relaxed 7/10
[23:03:25] verify | func= Background | rank= 6 | pid= hep-ph/0102108 | title_snip='An obvious isospin breaking correction to epsilon' of kinematical origâ€¦' | abs_len= 666
[23:03:28] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[23:03:28] select | verify relaxed 8/10
[23:03:28] verify | func= Background | rank= 7 | pid= astro-ph/0101330 | title_snip='Accretion Processes in the Nucleus of M31' | abs_len= 1631
[23:03:30] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[23:03:30] select | verify relaxed 9/10
[23:03:30] verify | func= Background | rank= 8 | pid= astro-ph/0101466 | title_snip='On the Distribution of X-ray Surface Brightness from Diffuse Gas' | abs_len= 1212
[23:03:33] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False
[23:03:33] select | verify relaxed 10/10
[23:03:33] verify | func= Background | rank= 9 | pid= astro-ph/0101467 | title_snip='The X-ray surface brightness distribution from diffuse gas' | abs_len= 1509
[23:03:35] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False

================================================================================
FUNCTION: Background
QUERY   : How does the new calculation of photoionization of interstellar matter build upon existing knowledge of the Complex of Local Interstellar Clouds?
- WINNER: astro-ph/0104234 | The Ionization of Nearby Interstellar Gas
- QUOTE : within ~5 pc of the Sun (which we refer to as the Complex of Local Interstellar Clouds or CLIC)
- WHY   : sufficient
- ANSWER: The new calculation of photoionization of interstellar matter builds upon existing knowledge of the Complex of Local Interstellar Clouds by incorporating directly observed radiation sources and modeling unobserved emission (astro-ph/0104234).

ðŸ“„ Saved: outputs/function_selection_results.json
ðŸ“„ Saved: outputs/function_selection_results.jsonl
ðŸ“ Answers-only: outputs/function_answers.txt
-> /home/anpa439f/anaconda3/envs/myenv/bin/python3 /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/classifying_question.py  (cwd=/data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration)
âœ… Saved to classified_outputs.jsonl
ðŸ”§ Ready for retrieval module (.py).
-> /home/anpa439f/anaconda3/envs/myenv/bin/python3 /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/Retreival_query_based.py --skip-reindex --index /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/e5_index_subset_1/index.faiss --meta /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/e5_index_subset_1/meta.parquet --topk 20  (cwd=/data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration)
âœ… Top-k candidates: /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
ðŸ”— Symlinked: /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/outputs/topk_candidates_query.jsonl -> /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
-> /home/anpa439f/anaconda3/envs/myenv/bin/python3 /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/function_based_answer-2.py --debug --max-check 10  (cwd=/data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration)

ðŸŽ‰ Pipeline complete.
  â€¢ Classified file : /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/classified_outputs.jsonl
  â€¢ TopK (canonical): /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
  â€¢ Final outputs   : /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs
