âœ… Available Models:
1. alias-code
2. alias-reasoning
3. alias-image-generation
4. alias-vision
5. alias-ha
6. meta-llama/Llama-3.3-70B-Instruct
7. meta-llama/Llama-3.1-8B-Instruct
8. Qwen/Qwen2-VL-7B-Instruct
9. openGPT-X/Teuken-7B-instruct-research-v0.4
10. deepseek-ai/DeepSeek-Coder-V2-Lite-Instruct
11. Qwen/Qwen3-Coder-30B-A3B-Instruct
12. Qwen/Qwen3-Embedding-4B
13. stabilityai/stable-diffusion-3.5-large-turbo
14. black-forest-labs/FLUX.1-dev
15. openai/whisper-large-v3
16. Kokoro-82M
17. tts-1-hd
18. deepseek-ai/DeepSeek-R1
19. openai/gpt-oss-120b
20. meta-llama/Llama-4-Scout-17B-16E-Instruct

ðŸ‘‰ Select a model number (default = 1): 
âœ… Using model: openai/gpt-oss-120b

ðŸ” Enter a scientific query or topic: 
ðŸ”Ž Citation Function Classification:
{
  "citation_functions": [
    "Compares",
    "FutureWork"
  ],
  "justification": "The query asks how the study's results compare with earlier Milky Way models (comparative) and seeks suggested future research directions (future work)."
}

âœ… Saved to classified_outputs.jsonl
ðŸ”§ Ready for retrieval module (handled in a separate file).
âš¡ SKIP_REINDEX=1 â€” using existing FAISS index + meta; not scanning raw JSONL shards.
âœ… Top-k candidates (FAISS): /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
[00:18:46] main | args: Namespace(max_check=10, debug=True)
[00:18:46] read_last_jsonl | path= classified_outputs.jsonl
[00:18:46] read_last_jsonl | total_lines= 1
[00:18:46] main | query='How do the results of this study compare to previous models of the Milky Way, and what future research directions are suggested by the findings on dark matter halo shapes and Galactic constants?' | funcs=['Compares', 'FutureWork']
[00:18:48] main | core_terms= ['Milky Way', 'dark matter halo', 'Galactic constants']
[00:18:48] load_topk_jsonl | path= /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/outputs/topk_candidates_query.jsonl
[00:18:48] load_topk_jsonl | rows= 20
[00:18:48] load_topk_jsonl | first: rank= 0 paper_id= astro-ph/0104465 title_snip='Luminous and Dark Matter in the Milky Way' abs_len= 1523
[00:18:48] main | running function= Compares
[00:18:48] select | function= Compares | candidates_in= 20
[00:18:48] select | core_terms= ['Milky Way', 'dark matter halo', 'Galactic constants']
[00:18:48] select | no cosine prune; kept=20/20
[00:18:48] select | pool_size= 10 | ranks= [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] | pids= ['astro-ph/0104465', 'astro-ph/0102436', 'astro-ph/0104293', 'astro-ph/0104242', 'astro-ph/0103430', 'astro-ph/0101528', 'astro-ph/0101210', 'astro-ph/0103386', 'astro-ph/0104069', 'astro-ph/0104404']
[00:18:48] select | verify relaxed 1/10
[00:18:48] verify | func= Compares | rank= 0 | pid= astro-ph/0104465 | title_snip='Luminous and Dark Matter in the Milky Way' | abs_len= 1523
[00:18:51] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= False
[00:18:51] select | verify relaxed 2/10
[00:18:51] verify | func= Compares | rank= 1 | pid= astro-ph/0102436 | title_snip='The Host Haloes of Lyman Break Galaxies and Sub-millimeter Sources' | abs_len= 1580
[00:18:54] verify | result supports= False fit= 0.00 top= 0.20 invalid= no_quote cue_hint= False
[00:18:54] select | verify relaxed 3/10
[00:18:54] verify | func= Compares | rank= 2 | pid= astro-ph/0104293 | title_snip='Direct Detection of Galactic Halo Dark Matter' | abs_len= 831
[00:18:57] verify | result supports= False fit= 0.00 top= 0.80 invalid= â€” cue_hint= False
[00:18:57] select | verify relaxed 4/10
[00:18:57] verify | func= Compares | rank= 3 | pid= astro-ph/0104242 | title_snip='The Thick Disk-Halo Interface' | abs_len= 940
[00:19:00] verify | result supports= False fit= 0.00 top= 0.50 invalid= â€” cue_hint= False
[00:19:00] select | verify relaxed 5/10
[00:19:00] verify | func= Compares | rank= 4 | pid= astro-ph/0103430 | title_snip='The Metamorphosis of Tidally Stirred Dwarf Galaxies' | abs_len= 1825
[00:19:03] verify | result supports= True fit= 0.80 top= 0.90 invalid= â€” cue_hint= False
[00:19:03] select | verify relaxed 6/10
[00:19:03] verify | func= Compares | rank= 5 | pid= astro-ph/0101528 | title_snip='Constraints on the warm dark matter model from gravitational lensing' | abs_len= 1068
[00:19:06] verify | result supports= False fit= 0.00 top= 0.90 invalid= off_topic_no_core_in_abstract cue_hint= True
[00:19:06] select | verify relaxed 7/10
[00:19:06] verify | func= Compares | rank= 6 | pid= astro-ph/0101210 | title_snip='A new test for the stable clustering hypothesis' | abs_len= 1194
[00:19:09] verify | result supports= False fit= 0.00 top= 0.20 invalid= â€” cue_hint= False
[00:19:09] select | verify relaxed 8/10
[00:19:09] verify | func= Compares | rank= 7 | pid= astro-ph/0103386 | title_snip='Dark Halos: The Flattening of the Density Cusp by Dynamical Friction' | abs_len= 1598
[00:19:12] verify | result supports= False fit= 0.00 top= 0.80 invalid= â€” cue_hint= False
[00:19:12] select | verify relaxed 9/10
[00:19:12] verify | func= Compares | rank= 8 | pid= astro-ph/0104069 | title_snip='The Equilibrium Structure of Cosmological Halos' | abs_len= 1238
[00:19:15] verify | result supports= False fit= 0.00 top= 0.90 invalid= off_topic_no_core_in_abstract cue_hint= True
[00:19:15] select | verify relaxed 10/10
[00:19:15] verify | func= Compares | rank= 9 | pid= astro-ph/0104404 | title_snip='The Formation Timescales of Giant Spheroids' | abs_len= 553
[00:19:17] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False

================================================================================
FUNCTION: Compares
QUERY   : How do the results of this study compare to previous models of the Milky Way, and what future research directions are suggested by the findings on dark matter halo shapes and Galactic constants?
- WINNER: astro-ph/0104465 | Luminous and Dark Matter in the Milky Way
- QUOTE : rule out two DM candidates that require a highly flattened DM halo
- WHY   : sufficient
- ANSWER: The study's results on dark matter halo shapes and Galactic constants are compared to previous models, suggesting that a significantly flattened dark matter halo is only possible if certain conditions are met, such as a smaller Galactic constant R_0. The findings rule out certain dark matter candidates and suggest future research directions, including investigating the effects of gaseous velocity dispersion and refining estimates of stellar column density (astro-ph/0104465).
[00:19:23] main | running function= FutureWork
[00:19:23] select | function= FutureWork | candidates_in= 20
[00:19:23] select | core_terms= ['Milky Way', 'dark matter halo', 'Galactic constants']
[00:19:23] select | no cosine prune; kept=20/20
[00:19:23] select | pool_size= 10 | ranks= [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] | pids= ['astro-ph/0104465', 'astro-ph/0102436', 'astro-ph/0104293', 'astro-ph/0104242', 'astro-ph/0103430', 'astro-ph/0101528', 'astro-ph/0101210', 'astro-ph/0103386', 'astro-ph/0104069', 'astro-ph/0104404']
[00:19:23] select | verify relaxed 1/10
[00:19:23] verify | func= FutureWork | rank= 0 | pid= astro-ph/0104465 | title_snip='Luminous and Dark Matter in the Milky Way' | abs_len= 1523
[00:19:25] verify | result supports= False fit= 0.00 top= 0.80 invalid= no_quote cue_hint= False
[00:19:25] select | verify relaxed 2/10
[00:19:25] verify | func= FutureWork | rank= 1 | pid= astro-ph/0102436 | title_snip='The Host Haloes of Lyman Break Galaxies and Sub-millimeter Sources' | abs_len= 1580
[00:19:28] verify | result supports= False fit= 0.00 top= 0.20 invalid= no_quote cue_hint= False
[00:19:28] select | verify relaxed 3/10
[00:19:28] verify | func= FutureWork | rank= 2 | pid= astro-ph/0104293 | title_snip='Direct Detection of Galactic Halo Dark Matter' | abs_len= 831
[00:19:31] verify | result supports= False fit= 0.00 top= 0.80 invalid= â€” cue_hint= False
[00:19:31] select | verify relaxed 4/10
[00:19:31] verify | func= FutureWork | rank= 3 | pid= astro-ph/0104242 | title_snip='The Thick Disk-Halo Interface' | abs_len= 940
[00:19:33] verify | result supports= False fit= 0.00 top= 0.80 invalid= quote_not_in_abstract cue_hint= False
[00:19:33] select | verify relaxed 5/10
[00:19:33] verify | func= FutureWork | rank= 4 | pid= astro-ph/0103430 | title_snip='The Metamorphosis of Tidally Stirred Dwarf Galaxies' | abs_len= 1825
[00:19:36] verify | result supports= False fit= 0.00 top= 0.80 invalid= no_quote cue_hint= False
[00:19:36] select | verify relaxed 6/10
[00:19:36] verify | func= FutureWork | rank= 5 | pid= astro-ph/0101528 | title_snip='Constraints on the warm dark matter model from gravitational lensing' | abs_len= 1068
[00:19:39] verify | result supports= False fit= 0.00 top= 0.90 invalid= off_topic_no_core_in_abstract cue_hint= False
[00:19:39] select | verify relaxed 7/10
[00:19:39] verify | func= FutureWork | rank= 6 | pid= astro-ph/0101210 | title_snip='A new test for the stable clustering hypothesis' | abs_len= 1194
[00:19:42] verify | result supports= False fit= 0.00 top= 0.20 invalid= â€” cue_hint= False
[00:19:42] select | verify relaxed 8/10
[00:19:42] verify | func= FutureWork | rank= 7 | pid= astro-ph/0103386 | title_snip='Dark Halos: The Flattening of the Density Cusp by Dynamical Friction' | abs_len= 1598
[00:19:45] verify | result supports= False fit= 0.00 top= 0.90 invalid= off_topic_no_core_in_abstract cue_hint= False
[00:19:45] select | verify relaxed 9/10
[00:19:45] verify | func= FutureWork | rank= 8 | pid= astro-ph/0104069 | title_snip='The Equilibrium Structure of Cosmological Halos' | abs_len= 1238
[00:19:48] verify | result supports= False fit= 0.00 top= 0.80 invalid= no_quote cue_hint= False
[00:19:48] select | verify relaxed 10/10
[00:19:48] verify | func= FutureWork | rank= 9 | pid= astro-ph/0104404 | title_snip='The Formation Timescales of Giant Spheroids' | abs_len= 553
[00:19:50] verify | result supports= False fit= 0.00 top= 0.00 invalid= no_quote cue_hint= False

================================================================================
FUNCTION: FutureWork
QUERY   : How do the results of this study compare to previous models of the Milky Way, and what future research directions are suggested by the findings on dark matter halo shapes and Galactic constants?
- No supporting candidate with sufficient evidence.
- ANSWER: The abstract does not provide information relevant to FutureWork.

ðŸ“„ Saved: outputs/function_selection_results.json
ðŸ“„ Saved: outputs/function_selection_results.jsonl
ðŸ“ Answers-only: outputs/function_answers.txt
-> /home/anpa439f/anaconda3/envs/myenv/bin/python3 /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/classifying_question.py  (cwd=/data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration)
âœ… Saved to classified_outputs.jsonl
ðŸ”§ Ready for retrieval module (.py).
-> /home/anpa439f/anaconda3/envs/myenv/bin/python3 /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/Retreival_query_based.py --skip-reindex --index /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/e5_index_subset_1/index.faiss --meta /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/e5_index_subset_1/meta.parquet --topk 20  (cwd=/data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration)
âœ… Top-k candidates: /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
ðŸ”— Symlinked: /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/outputs/topk_candidates_query.jsonl -> /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
-> /home/anpa439f/anaconda3/envs/myenv/bin/python3 /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/function_based_answer-2.py --debug --max-check 10  (cwd=/data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration)

ðŸŽ‰ Pipeline complete.
  â€¢ Classified file : /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/classified_outputs.jsonl
  â€¢ TopK (canonical): /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs/topk_candidates_query.jsonl
  â€¢ Final outputs   : /data/horse/ws/anpa439f-Function_Retrieval_Citation/Research_Project/RetrievalAugmentedGeneration/outputs
